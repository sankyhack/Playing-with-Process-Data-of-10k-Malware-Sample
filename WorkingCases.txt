1) Search Lolbin EXE's

data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'w')

for line in data:
    lolbin = open(r"EXE_All_LOLBin.txt", 'r')
    for lol_check in lolbin:
        if lol_check in line:
            lol_found.write(line)

-------------------------------------

2) Print max occuring exe

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:
    #print(line)
    try:
        lolholder =  lolholder.append({ 'ProcName' : (line.split()[0])}, ignore_index=True)
    except:
        print(line)


print(lolholder['ProcName'].value_counts(ascending=False).head(10)

--------------------------------------

3) User Directories from where malware runs

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:

    try:
        if re.match(r"C:\\Users", line):
            #print(test)
            lolholder =  lolholder.append({ 'ProcName' : (line.split()[0])}, ignore_index=True)
    except Exception as e:
        print(e)


print(lolholder['ProcName'].value_counts(ascending=False).head(10))

--------------------------------------

4) Exe's using http:// or https://

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:

    try:
        if re.search(r"http|https:\\\\", line):
            #print(line)
            lolholder =  lolholder.append({ 'ProcName' : (line.split()[0])}, ignore_index=True)
    except Exception as e:
        print(e)


print(lolholder['ProcName'].value_counts(ascending=False).head(10))

--------------------------------------

5) Applications running DLL

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:

    try:
        temp = line.split()
        #print(temp)
        for i in range(1, len(temp)):
            #print(temp[i])
            if re.search(r'\.dll',temp[i]):
                lolholder =  lolholder.append({ 'ProcName' : (line.split()[0])}, ignore_index=True)
    except Exception as e:
        print(e)

print(lolholder['ProcName'].value_counts(ascending=False).head(10))

-------------------------------------------

6) Searching for 'temp' keyword

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')


lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:

    try:
        if re.search(r"temp", line, re.IGNORECASE):
            # print(test)
            lolholder = lolholder.append({'ProcName': (line.split()[0])}, ignore_index=True)
    except Exception as e:
        print(e)

print(lolholder['ProcName'].value_counts(ascending=False))

----------------------------------------

7) rundll32.exe running files in temp or rundll32 running from temp

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')


lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:

    try:
        if re.search(r"temp", line, re.IGNORECASE) and re.search(r"rundll32.exe", line, re.IGNORECASE):
            # print(test)
            lolholder = lolholder.append({'ProcName': (line.split()[0])}, ignore_index=True)
    except Exception as e:
        print(e)

print(lolholder['ProcName'].value_counts(ascending=False))

----------------------------------------

8) non exe running dll files

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"lolfound.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:
    try:
        temp = line.split()
        #print(temp[0])
        if (not (re.search(r"(\.exe)", temp[0], re.IGNORECASE))) and (re.search(r"(\.dll)", line, re.IGNORECASE)) :
            #print(line)
            lolholder = lolholder.append({'ProcName': line}, ignore_index=True)
    except Exception as e:
        continue

print(lolholder['ProcName'].value_counts(ascending=False))


-------------------------------------------------------

9_ rundll32.exe running .hta or .url

import pandas as pd
data = open(r"C:\Users\Admin\Desktop\Study\Python\Output\Merge\1.txt", 'r')
lol_found = open(r"merge.txt", 'r+')

lolholder = pd.DataFrame(columns=['ProcName'], )

for line in lol_found:
    try:
        temp = line.split()
        #print(temp[0])
        if ((re.search(r"(rundll32.exe)", line, re.IGNORECASE))) and (re.search(r"(\.hta)|(\.url)", line, re.IGNORECASE)) :
            #print(line)
            lolholder = lolholder.append({'ProcName': line}, ignore_index=True)
    except Exception as e:
        continue

print(lolholder['ProcName'].value_counts(ascending=False))

